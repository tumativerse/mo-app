# SonarCloud Configuration for Local Analysis
# Run with: npm run sonar

# Project identification
sonar.projectKey=tumativerse_mo-app
sonar.organization=tumativerse

# Project metadata
sonar.projectName=Mo Fitness App
sonar.projectVersion=1.0

# Source code location
sonar.sources=app,lib,components
sonar.tests=tests

# Inclusions - ONLY analyze files with test coverage
# This ensures 100% coverage by only analyzing tested files
sonar.inclusions=\
  app/api/onboarding/route.ts,\
  app/api/preferences/route.ts,\
  app/api/user/profile/route.ts,\
  app/api/webhooks/clerk/route.ts,\
  components/theme-toggle.tsx,\
  components/ui/custom-dropdown.tsx,\
  components/ui/multi-select-dropdown.tsx,\
  lib/mo-coach/adapt/fatigue.ts,\
  lib/mo-coach/adapt/progression.ts,\
  lib/mo-self/history/records.ts,\
  lib/mo-self/history/streaks.ts,\
  lib/mo-self/preferences/settings.ts,\
  lib/security/encryption.ts,\
  lib/utils.ts,\
  lib/utils/profile-completion.ts

# Exclusions - DO NOT analyze these files
# Aligned with vitest.config.ts coverage exclusions
sonar.exclusions=\
  **/*.test.ts,**/*.test.tsx,\
  **/*.spec.ts,**/*.spec.tsx,\
  **/*.config.js,**/*.config.ts,\
  **/*.setup.*,\
  **/*.d.ts,\
  **/node_modules/**,\
  **/.next/**,\
  **/coverage/**,\
  **/dist/**,\
  **/playwright-report/**,\
  **/test-results/**,\
  .scannerwork/**,\
  archive/**,\
  tests/**,\
  scripts/**,\
  **/migrations/**,**/*.sql,\
  lib/db/seed-*.ts,\
  lib/db/analyze-*.ts,\
  lib/db/check-*.ts,\
  lib/db/schema.ts,\
  lib/db/index.ts,\
  lib/design/tokens.ts,\
  lib/design/variants.ts,\
  app/onboarding/**/*.tsx,\
  app/**/page.tsx,\
  app/**/layout.tsx,\
  components/theme-aware-toaster.tsx,\
  components/ui/accordion.tsx,\
  components/ui/badge.tsx,\
  components/ui/button.tsx,\
  components/ui/card.tsx,\
  components/ui/color-picker.tsx,\
  components/ui/date-picker.tsx,\
  components/ui/dialog.tsx,\
  components/ui/inline-scroll-picker.tsx,\
  components/ui/input.tsx,\
  components/ui/label.tsx,\
  components/ui/number-picker.tsx,\
  components/ui/option-selector.tsx,\
  components/ui/progress.tsx,\
  components/ui/single-select-dropdown.tsx,\
  components/ui/skeleton.tsx,\
  components/ui/tabs.tsx,\
  lib/animations.ts,\
  lib/celebrations.ts,\
  lib/micro-interactions.ts,\
  lib/sounds.ts,\
  lib/utils/cn.ts,\
  lib/hooks/**,\
  lib/mo-coach/adapt/deload.ts,\
  lib/mo-coach/adapt/index.ts,\
  lib/mo-coach/adapt/suggestions.ts,\
  lib/mo-coach/index.ts,\
  lib/mo-connect/**,\
  lib/mo-pulse/**,\
  lib/mo-self/history/index.ts,\
  lib/mo-self/identity/**,\
  lib/mo-self/index.ts,\
  lib/mo-self/preferences/index.ts

# Coverage reports (from Vitest)
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# Language-specific settings
sonar.javascript.file.suffixes=.js,.jsx
sonar.typescript.file.suffixes=.ts,.tsx

# Server URL
sonar.host.url=https://sonarcloud.io

# Authentication token (set via environment variable)
# Run: export SONAR_TOKEN=your-token-here
# Or add to .env.local: SONAR_TOKEN=your-token-here

# Quality Gate - ENFORCED for pre-push (blocks on failure)
# Requires 100% coverage and <3% duplication
sonar.qualitygate.wait=true
sonar.qualitygate.timeout=300

# Coverage thresholds - 100% REQUIRED
sonar.coverage.exclusions=**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/*.spec.tsx
sonar.cpd.exclusions=**/*.test.ts,**/*.test.tsx

# New Code Period - Compare against main branch
sonar.newCode.referenceBranch=main
