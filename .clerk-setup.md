# Clerk Authentication Setup

## Application Details

**Clerk Application:** Tumati Apps
**Purpose:** Shared authentication for all tumati.me applications
**Domain:** tumati.me

## How It Works

This is a **single Clerk application** that provides authentication for ALL apps under the tumati.me domain:

- âœ… mo.tumati.me (Mo Fitness App)
- âœ… taskflow.tumati.me (future)
- âœ… Any other *.tumati.me apps you create

**Benefits:**
- Users have ONE account across all your apps (single sign-on)
- Clean URLs using clerk.tumati.me
- Shared user database
- Easier to manage (one set of API keys)

## DNS Configuration

All 5 DNS records point to the shared Clerk infrastructure:

```
clerk.tumati.me â†’ frontend-api.clerk.services
accounts.tumati.me â†’ accounts.clerk.services
clkmail.tumati.me â†’ mail.2dmiwn3hlziy.clerk.services
clk._domainkey.tumati.me â†’ dkim1.2dmiwn3hlziy.clerk.services
clk2._domainkey.tumati.me â†’ dkim2.2dmiwn3hlziy.clerk.services
```

**Managed in:** Cloudflare DNS (free tier)
**Zone ID:** 5bc048b04d7d5f46d1bd8cc97500a1c5

## API Keys (Production)

**Environment Variables:**
```bash
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_live_Y2xlcmsudHVtYXRpLm1lJA
CLERK_SECRET_KEY=sk_live_z1WO1GoasnrUinsCIb1AabnfMUbGTbeOPXXQj2tK4Y
```

**Stored in:** Vercel environment variables (production)

## Adding New Apps

When you create a new app under tumati.me (e.g., taskflow.tumati.me):

1. **Use the SAME Clerk API keys** (same "Tumati Apps" application)
2. **No new DNS records needed** - the existing 5 records work for all apps
3. **Users can log in with existing accounts** - seamless single sign-on

### Example: Adding Taskflow

```bash
# In your new taskflow app
vercel env add NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY production
# Paste: pk_live_Y2xlcmsudHVtYXRpLm1lJA

vercel env add CLERK_SECRET_KEY production
# Paste: sk_live_z1WO1GoasnrUinsCIb1AabnfMUbGTbeOPXXQj2tK4Y
```

That's it! No DNS changes, no new Clerk app needed.

## Clerk Dashboard

**Access:** https://dashboard.clerk.com
**Application:** Tumati Apps
**Instance:** Production

**Key Settings:**
- Domain: tumati.me
- Sign-in methods: Email, Google
- Theme: Dark mode
- All DNS records verified âœ…

## Security Notes

- âœ… Production keys in use (no development key warnings)
- âœ… Custom domain with SSL certificates
- âœ… Email sending configured via Clerk
- âœ… All deprecated props replaced (fallbackRedirectUrl)

## Troubleshooting

### "Missing required parameter: client_id"
- Keys are mismatched or from different Clerk applications
- Solution: Verify both keys are from "Tumati Apps" â†’ Production

### DNS verification fails
- Email records have instance-specific identifiers (2dmiwn3hlziy)
- If you ever recreate the Clerk app, update the 3 email DNS records

### Deprecation warnings
- Check that SignIn/SignUp use `fallbackRedirectUrl` (not `afterSignInUrl`)
- Check that no old NEXT_PUBLIC_CLERK_AFTER_* env vars exist

## Created

- **Date:** December 31, 2024
- **Clerk App:** Tumati Apps
- **Production Instance:** tumati.me
- **First App:** Mo (mo.tumati.me)

---

**Remember:** This is a shared auth system for ALL your tumati.me apps. Don't create separate Clerk applications for each app - just reuse these keys! ðŸŽ‰
